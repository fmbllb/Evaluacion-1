{% extends "aplicacion/base.html" %}
{% load crispy_forms_tags %}

{% block contenido %}
<div class="row">
    <div class="col-sm-3"></div>
    <div class="col-sm-6">
        <div class="container mt-5">
            <h2>Crear Pedido</h2>
            <form method="post">
                {% csrf_token %}
                {{ compra_form|crispy }}
                {% if carrito.items.all %}
                <div id="productos-compra">
                    {% for item in carrito.items.all %}
                    <div class="card mb-3">
                        <div class="card-body">
                            <label for="producto">Producto:</label>
                            <h2 class="card-title">{{ item.producto.nombre }}</h2>
                            <input type="hidden" name="productos_ids" value="{{ item.producto.id }}">
                            <img src="{{ item.producto.foto.url }}" alt="{{ item.producto.nombre }}" class="img-fluid card-img-top mb-3">
                            <div class="mb-3">
                                <label for="cantidad">Cantidad:</label>
                                <input type="number" name="cantidades" class="form-control" min="1" value="{{ item.cantidad }}">
                            </div>
                            <div class="mb-3">
                                <label for="precio">Precio Unitario:</label>
                                <p class="card-text">${{ item.producto.precio }}</p>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    <div class="card mt-3">
                        <div class="card-body">
                            <label for="total"><strong>Total:</strong></label>
                            <p class="card-text">${{ total }}</p>
                        </div>
                    </div>
                </div>
                <div class="mb-3 mt-3">
                    <button type="submit" class="btn btn-primary d-grid gap-2 col-4 mx-auto">Crear Pedido</button>
                </div>
                {% else %}
                <div class="mt-3">
                    <h2>No hay productos en el carrito</h2>
                    <a href="{% url 'carrito' %}" class="btn btn-primary">Volver</a>
                </div>
                {% endif %}
            </form>
        </div>
    </div>
    <div class="col-sm-3"></div>
</div>
{% endblock %}
